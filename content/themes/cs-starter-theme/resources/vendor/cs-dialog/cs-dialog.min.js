var CsDialog=function(e){this.id="cs-dialog-"+Date.now(),this.cloak=null,this.activeDialog=null,this.content="",this.footerText="",this.config=CsUtils.mergeOptions({debug:!1,cache:!0,cloak:!0,padding:!0,keyboard:!0,dialogLinks:!0,position:"absolute",closeOnCloakClick:!0,effect:{fade:!1}},e),this.config.cloak&&this.renderCloakHtml(),this.config.dialogLinks&&this.dialogLinksHandler(),this.config.keyboard&&this.keyboardHandler()};CsDialog.prototype.dialogLinksHandler=function(){for(var e=document.querySelectorAll("[data-cs-dialog]"),t=0;t<e.length;t++)CsUtils.addEvent(e[t],"click",function(e){e.preventDefault();var t=e.currentTarget?e.currentTarget:e.srcElement;switch(t.getAttribute("data-cs-dialog")){case"partial":this.partialHandler(t);break;case"hidden-element":this.hiddenElementHandler(t);break;case"image":this.imageHandler(t);break;case"gallery":this.galleryHandler(t)}}.bind(this))},CsDialog.prototype.keyboardHandler=function(){document.onkeydown=function(e){switch(e.keyCode){case 37:this.switchImageHandler(null,"backwards");break;case 39:this.switchImageHandler(null,"forwards");break;case 27:this.closeDialog()}}.bind(this)},CsDialog.prototype.partialHandler=function(e){var t={title:e.getAttribute("data-title"),url:e.getAttribute("data-url")};null!==t.url&&""!==t.url&&"javascript:"!==t.url&&"#"!==t.url&&this.openUrl(t.title,t.url)},CsDialog.prototype.hiddenElementHandler=function(e){var t={id:e.getAttribute("data-id"),title:e.getAttribute("data-title")};if(null!==t.id){var i=document.getElementById(t.id),n=document.createElement("div");n.appendChild(i.firstChild.cloneNode(!0)),this.content=n.innerHTML,this.openDialog(t.title)}},CsDialog.prototype.imageHandler=function(e){var t={title:e.getAttribute("data-cs-title"),imageUrl:e.getAttribute("data-cs-image-url")};if(this.config.padding=!1,null!==t.imageUrl){var i=document.createElement("img");i.src=t.imageUrl,i.className="cs-dialog__img",this.content=i.outerHTML,this.openDialog(t.title)}},CsDialog.prototype.galleryHandler=function(e){var t={title:e.getAttribute("data-cs-title"),imageUrl:e.getAttribute("data-cs-image-url"),index:parseInt(e.getAttribute("data-cs-index"))};if(this.config.padding=!1,null!==t.imageUrl){var i=document.createElement("img");i.src=t.imageUrl,i.className="cs-dialog__img";var n=document.createElement("div");n.appendChild(i);var o=document.querySelectorAll('[data-cs-dialog="gallery"]');if(1<o.length){if(t.index<o.length){var a=document.createElement("a");a.href="javascript:;",a.className="cs-dialog__nav cs-dialog__nav--next",a.setAttribute("data-cs-index",(t.index+1).toString());var l=document.createElement("i");l.className="fas fa-angle-right",a.appendChild(l),CsUtils.addEvent(a,"click",function(e){this.switchImageHandler(e,1)}.bind(this)),n.appendChild(a)}if(1<t.index){var s=document.createElement("a");s.href="javascript:;",s.className="cs-dialog__nav cs-dialog__nav--previous",s.setAttribute("data-cs-index",(t.index-1).toString());var r=document.createElement("i");r.className="fas fa-angle-left",s.appendChild(r),CsUtils.addEvent(s,"click",function(e){this.switchImageHandler(e,-1)}.bind(this)),n.appendChild(s)}}this.content=n,this.openDialog(t.title)}},CsDialog.prototype.switchImageHandler=function(e,t){var i=null,n=null,o=document.querySelectorAll('[data-cs-dialog="gallery"]');if(i=e?e.currentTarget?e.currentTarget:e.srcElement:"backwards"===t?this.activeDialog.getElementsByClassName("cs-dialog__nav--previous")[0]:this.activeDialog.getElementsByClassName("cs-dialog__nav--next")[0]){for(var a=0;a<o.length;a++){var l=o[a].getAttribute("data-cs-index");i.getAttribute("data-cs-index")===l&&(n=o[a])}if(null!==n){var s=this.config.effect.fade;this.config.effect.fade=!1,this.galleryHandler(n),this.config.effect.fade=s}}},CsDialog.prototype.openUrl=function(t,e,i){var n=this;CsUtils.get(e).then(function(e){n.content=e,n.positionDialog(),n.openDialog(t,i)}).catch(function(e){console.error(e)})},CsDialog.prototype.openDialog=function(e,t){var i=this;this.title=e,"undefined"!=typeof Promise?i.activeDialog?(i.resetContent(),i.updateActiveDialog().then(function(){i.positionDialog(),"function"==typeof t&&t()})):i.renderDialog().then(function(e){i.positionDialog(),"function"==typeof t&&t()}):CsUtils.waitForPolyfillsToLoad(function(){i.openDialog(e,t)})},CsDialog.prototype.renderDialog=function(){var e=this.renderDialogHtml(),t=document.getElementsByTagName("body")[0],i=this,n=0;return i.config.debug&&(n=500),t.appendChild(e),this.activeDialog=e,Promise.all([i.showDialog(),i.appendTitle(i.title),i.appendContent(i.content,n)]).then(function(){return e})},CsDialog.prototype.updateActiveDialog=function(){var e=this,t=0;return e.config.debug&&(t=500),Promise.all([this.showDialog(),e.appendTitle(e.title),e.appendContent(e.content,t)]).then(function(){return e.activeDialog})},CsDialog.prototype.showDialog=function(){var i=this.activeDialog,n=this;return new Promise(function(e,t){n.config.cloak&&n.openCloak(),n.positionDialog(),i.style.display="block",n.config.effect.fade?CsUtils.fadeIn(i,function(){CsUtils.runEmbeddedJs(i),e()}):(CsUtils.runEmbeddedJs(i),i.style.opacity="1",e())})},CsDialog.prototype.positionDialog=function(){var t=(window.pageYOffset||document.body.scrollTop)-(document.body.clientTop||0),i=Math.max(document.documentElement.clientHeight,window.innerHeight||0),n=this.activeDialog;CsUtils.waitForElement(n,function(){var e=i-i/10;n.style.height="auto",n.style.overflowY="visible",n.offsetHeight>e&&(n.style.overflowY="scroll",n.style.height=e+"px"),"fixed"===this.config.position&&(t=0,n.style.position="fixed"),n.style.top=t+i/2-n.offsetHeight/2+"px",this.config.debug&&(console.log("dialog.offsetHeight: "+n.offsetHeight),console.log("screenHeight: "+i),console.log("positionTop: "+t),console.log("maxHeight: "+e))}.bind(this))},CsDialog.prototype.closeDialog=function(){var e=this.activeDialog||null;void 0!==e&&(this.activeDialog.style.display="none",this.config.cache||(e.parentNode.removeChild(e),this.activeDialog=null),this.closeCloak())},CsDialog.prototype.openCloak=function(){var e=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);void 0!==this.cloak&&(this.cloak.setAttribute("style","height: "+e+"px"),this.cloak.className=this.cloak.className.replace(/\bhide\b/g,""))},CsDialog.prototype.closeCloak=function(){void 0!==this.cloak&&-1===this.cloak.className.indexOf("hide")&&(this.cloak.className+=" hide")},CsDialog.prototype.appendTitle=function(n){var o=this;if(void 0!==o.activeDialog)return new Promise(function(e,t){var i=o.activeDialog.getElementsByClassName("cs-dialog__header")[0];void 0!==i?(i.getElementsByClassName("cs-dialog__title")[0].innerHTML=n,e()):t()})},CsDialog.prototype.appendContent=function(n,e){e=e||0;var o=this;if(void 0!==o.activeDialog)return new Promise(function(t,i){setTimeout(function(){var e=o.activeDialog.getElementsByClassName("cs-dialog__body")[0];void 0!==e?("object"==typeof n?(e.innerHTML="",e.append(n)):e.innerHTML=n,t()):i()},e)})},CsDialog.prototype.resetContent=function(){this.activeDialog.getElementsByClassName("cs-dialog__body")[0].innerHTML=this.renderSpinnerHtml()},CsDialog.prototype.renderCloakHtml=function(){var e=document.createElement("div"),t=document.getElementsByTagName("body")[0];return e.className="cs-dialog-cloak hide",t.insertBefore(e,t.firstChild),this.config.closeOnCloakClick&&CsUtils.addEvent(e,"click",function(e){e.target!==this.activeDialog&&this.closeDialog()}.bind(this)),this.cloak=e},CsDialog.prototype.renderDialogHtml=function(){var e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("div"),n=document.createElement("header"),o=document.createElement("footer"),a=document.createElement("div"),l=document.createElement("div"),s=document.createElement("h2"),r=document.createElement("a"),c=document.createElement("i");return e.id=this.id,e.className="cs-dialog extend hide",this.config.padding&&(e.className+=" cs-dialog--padding"),t.className="cs-dialog__inner",e.appendChild(t),n.className="cs-dialog__header",t.appendChild(n),a.className="cs-dialog__container-master",n.appendChild(a),s.className="cs-dialog__title",a.appendChild(s),l.className="cs-dialog__container-slave",l.style.textAlign="right",n.appendChild(l),c.className="fas fa-times",r.appendChild(c),r.href="JavaScript:;",r.className="cs-dialog__close-btn",l.appendChild(r),CsUtils.addEvent(r,"click",this.closeDialog.bind(this)),i.className="cs-dialog__body",i.innerHTML=this.renderSpinnerHtml(),t.appendChild(i),""!==this.footerText&&(o.className="cs-dialog__footer",o.innerHTML=this.footerText,t.appendChild(o)),e},CsDialog.prototype.setFooterText=function(e){this.footerText=e},CsDialog.prototype.renderSpinnerHtml=function(){return'<svg class="cs-dialog__spinner" viewBox="0 0 100 100" width="50" height="50"> <circle cx="50" cy="50" r="42" transform="rotate(-90,50,50)" /></svg>'},CsDialog.prototype.openWithContent=function(e,t,i){this.openDialog(e,function(){this.appendContent(t).then(function(e){"function"==typeof i&&i()})}.bind(this))};var CsUtils={isIe:function(){return 0<window.navigator.userAgent.indexOf("MSIE ")||!!navigator.userAgent.match(/Trident.*rv\:11\./)},isDomReady:function(e){/in/.test(document.readyState)?setTimeout(function(){CsUtils.isDomReady(e)},10):e()},loadPolyFills:function(){"undefined"==typeof Promise&&null===document.getElementById("script-promise-polyfill")&&CsUtils.waitForElement(document.getElementsByTagName("head")[0],function(e){var t=document.createElement("script");t.type="text/javascript",t.src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js",t.id="script-promise-polyfill",e.insertBefore(t,e.firstChild)})},waitForPolyfillsToLoad:function(e){"undefined"==typeof Promise?(CsUtils.loadPolyFills(),console.info("Waiting for Promise polyfill to load..."),setTimeout(function(){CsUtils.waitForPolyfillsToLoad(e)}.bind(this),50)):e()},addEvent:function(e,t,i){e.attachEvent?(e["e"+t+i]=i,e[t+i]=function(){e["e"+t+i](window.event)},e.attachEvent("on"+t,e[t+i])):e.addEventListener(t,i,!1)},get:function(n){var e=new Promise(function(e,t){var i=new XMLHttpRequest;i.open("GET",n),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.onload=function(){200===i.status?e(i.response):t(Error(i.statusText))},i.send()});return Promise.all([e]).then(function(e){return e[0]})},waitForElement:function(e,t){var i=setInterval(function(){e&&(clearInterval(i),t(e))},10)},fadeIn:function(e,t){e.style.opacity=0;var i=function(){e.style.opacity=+e.style.opacity+.05,+e.style.opacity<1?window.requestAnimationFrame&&requestAnimationFrame(i)||setTimeout(i,16):"function"==typeof t&&t()};i()},mergeOptions:function(e,t){var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);for(var o in t)t.hasOwnProperty(o)&&(i[o]=t[o]);return i},runEmbeddedJs:function(container){if(void 0!==container)for(var scripts=container.getElementsByTagName("script"),i=0;i<scripts.length;i++)eval(scripts[i].text)}};